<!DOCTYPE html>
<html>
<head>
  <title>Product Details</title>
  <style>
    body {font-family: Arial; margin:20px; background:#f5f5f5;}
    .container {display:flex; gap:20px; flex-wrap:wrap;}
    .main-img {width:300px; height:300px; object-fit:contain;}
    .details {max-width:500px;}
    .title {font-size:24px;font-weight:bold;}
    .price {color:green;font-weight:bold;font-size:20px;margin:10px 0;}
    .rating {color:orange;}
    .qty-box {display:flex; gap:10px; margin:10px 0;}
    .qty-box button {width:28px; height:28px; cursor:pointer;}
    .wish-btn {padding:8px 12px;background:#ff3d00;color:white;border:none;border-radius:5px;cursor:pointer;}
    .similar-products {margin-top:30px;}
    .similar-products h3 {margin-bottom:10px;}
    .card {width:150px; display:inline-block; margin-right:10px; cursor:pointer; text-align:center;}
    .card img {width:100%; height:100px; object-fit:contain;}

    /* footer */

    footer {
  background: #222;
  color: #fff;
  padding: 15px 20px;
  text-align: center;
  margin-top: 40px;
}

footer p {
  margin: 5px 0;
  font-size: 14px;
}

footer a {
  color: #ff3d00;
  text-decoration: none;
  margin: 0 8px;
  font-size: 14px;
}

footer a:hover {
  text-decoration: underline;
}

  </style>
</head>
<body>
  <button onclick="goBack()">← Back</button>
<h1>Product Details</h1>
  <div class="container">
    <img id="prod-img" class="main-img">
    <div class="details">
      <div class="title" id="prod-title"></div>
      <div class="price" id="prod-price"></div>
      <div class="rating" id="prod-rating"></div>
      <div class="qty-box">
        <button onclick="changeQty(-1)">−</button>
        <span id="prod-qty">1</span>
        <button onclick="changeQty(1)">+</button>
      </div>
      <button id="wish-btn" class="wish-btn"></button>
    </div>
  </div>

  <div class="similar-products">
    <h3>Similar Products</h3>
    <div id="similar-container"></div>
  </div>

  <!-- footer -->
  <footer>
  <p>© 2026 MyStore. All Rights Reserved.</p>
  <p>
    <a href="#">About</a> |
    <a href="#">Contact</a> |
    <a href="#">Privacy Policy</a>
  </p>
</footer>


<script>
  var currentUser = localStorage.getItem("currentUser") || sessionStorage.getItem("currentUser");
  if(!currentUser) {alert("Please login"); window.location.href="index.html";}

  var allProducts = [];
  var wishlist = JSON.parse(localStorage.getItem(`wishlist_${currentUser}`)||"[]");
  var selectedId = parseInt(localStorage.getItem("selectedProduct"));
  var selectedProduct = null;

  fetch("https://dummyjson.com/products")
    .then(res=>res.json())
    .then(data=>{
      allProducts = data.products.map(p=>{p.qty=1; p.basePrice=p.price; return p;});
      wishlist.forEach(w=>{
        var prod = allProducts.find(p=>p.id===w.id);
        if(prod) prod.qty = w.qty;
      });

      selectedProduct = allProducts.find(p=>p.id===selectedId);
      if(!selectedProduct) {alert("Product not found"); window.location.href="index.html";}
      if(wishlist.some(w=>w.id===selectedProduct.id)) selectedProduct.qty = wishlist.find(w=>w.id===selectedProduct.id).qty;
      showProductDetails();
      showSimilar();
    });

  function showProductDetails() {
    document.getElementById("prod-img").src = selectedProduct.thumbnail;
    document.getElementById("prod-title").innerText = selectedProduct.title;
    document.getElementById("prod-price").innerText = `₹${selectedProduct.basePrice * selectedProduct.qty}`;
    document.getElementById("prod-rating").innerText = `⭐ ${selectedProduct.rating}`;
    document.getElementById("prod-qty").innerText = selectedProduct.qty;

    var isWish = wishlist.some(w=>w.id===selectedProduct.id);
    var btn = document.getElementById("wish-btn");
    btn.innerText = isWish ? "Remove from Wishlist" : "Add to Wishlist";
  }

  function changeQty(delta) {
    if(delta===-1 && selectedProduct.qty===1) return;
    selectedProduct.qty += delta;
    document.getElementById("prod-qty").innerText = selectedProduct.qty;
    document.getElementById("prod-price").innerText = `₹${selectedProduct.basePrice * selectedProduct.qty}`;

    var wishProduct = wishlist.find(w=>w.id===selectedProduct.id);
    if(wishProduct) {
      wishProduct.qty = selectedProduct.qty;
      localStorage.setItem(`wishlist_${currentUser}`, JSON.stringify(wishlist));
    }
  }

  document.getElementById("wish-btn").addEventListener("click", ()=>{
    var index = wishlist.findIndex(w=>w.id===selectedProduct.id);
    if(index===-1) wishlist.push({...selectedProduct});
    else wishlist.splice(index,1);
    localStorage.setItem(`wishlist_${currentUser}`, JSON.stringify(wishlist));
    showProductDetails();
  });

  function showSimilar() {
    var container = document.getElementById("similar-container");
    container.innerHTML = "";
    var similar = allProducts.filter(p=>p.category===selectedProduct.category && p.id!==selectedProduct.id).slice(0,5);
    similar.forEach(p=>{
      var div = document.createElement("div");
      div.className="card";
      div.innerHTML=`<img src="${p.thumbnail}"><div>${p.title}</div><div>₹${p.price}</div>`;
      div.onclick=()=>{localStorage.setItem("selectedProduct",p.id); location.reload();};
      container.appendChild(div);
    });
  }

  function goBack(){window.location.href="productsAPI.html";}
</script>
</body>
</html>
